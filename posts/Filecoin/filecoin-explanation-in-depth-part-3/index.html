<!DOCTYPE html><html><head><meta charset="UTF-8"/><meta name="og:site_name" content="Tech Diarios"/><link rel="canonical" href="https://tech-diarios.io/posts/Filecoin/filecoin-explanation-in-depth-part-3"/><meta name="twitter:url" content="https://tech-diarios.io/posts/Filecoin/filecoin-explanation-in-depth-part-3"/><meta name="og:url" content="https://tech-diarios.io/posts/Filecoin/filecoin-explanation-in-depth-part-3"/><title>Filecoin explanation in depth (ep-03) | Tech Diarios</title><meta name="twitter:title" content="Filecoin explanation in depth (ep-03) | Tech Diarios"/><meta name="og:title" content="Filecoin explanation in depth (ep-03) | Tech Diarios"/><meta name="description" content="The Storage Subsystem"/><meta name="twitter:description" content="The Storage Subsystem"/><meta name="og:description" content="The Storage Subsystem"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Tech Diarios"/></head><body><header><div class="wrapper"><nav class="site-name"><a href="/">Tech Diarios</a></nav></div></header><div class="wrapper"><article><div class="content"><h1>Filecoin explanation in depth (ep-03)</h1><p>These episodes are explanations of Filecoin more deeply than the other post I have as “Filecoin explanation in a very simple way”.</p><p>In miner node architecture the Storage FSM is responsible for getting data from deals.<br>- The storage subsystem has two main tasks: - Store sector data - Schedule and run sealing operation</p><h2>The architecture of storage contains 6 parts</h2><h3>Paths</h3><p>We address storage as paths. Storage is divided into paths. Each path is just a directory with a bit of metadata. Both the main miner node and worker nodes can have multiple paths.<br>There are two types of paths, storage paths for longterm sector storage and seiling or squarespace. Sealing paths for keeping temporary data for sealing operations. We also can combine and have a path with both of them; But as we need speed for sealing operations we need SSDs which are expensive, so it’s better to use them just for sealing.<br>Each storage path has a UUID, weight, and flags specifying what it should be used for.</p><h3>Remote Paths</h3><p>Storing is further divided into Local and Remote storage. Each node can have a different set of local paths(zero or more). Sometimes sectors need to be moved between nodes and this is when remote paths come in handy. Each local path in the system is exposed by it’s node through HTTP(so nodes can transfer sectors themselves).</p><h3>Workers</h3><p>Worker is responsible for executing sealing tasks on sectors stored in local storage. If needed sector data isn’t available in local storage paths, it will be acquired from remote storage paths first. Each worker has access to a number of storage paths and paths can be shared between workers.</p><h3>Scheduling</h3><p>The logic that decides what, when, and where tasks run. Needs to avoid running out of resources and to utilize resources optimally( optimizing for sealing throughput). Balancing the use of RAM, scratch storage, CPUs, GPUs, network bandwidth, sealing throughput, latency, ....</p><h3>Scheduling Strategy</h3><p>Initially all tasks will go into the global scheduling queue, the main scheduler assigns them to worker windows. Tasks are assigned to workers in windows and after that workers start processing tasks.</p><h3>Resource Windows</h3><p>Resource windows are here mostly to prevent resource starvation. Window size is defined by worker resources. Each worker has four windows; One for running tasks, one for preparing tasks( used for fetching sector data), and two windows for getting tasks from the scheduler.<br><br>- The global scheduler operates on open(empty) windows.<br>- Workers always have 2 open assigned windows.<br>- Per task resource table is being used to allocate tasks to windows and also is defined in extern/sector-storage/resource.go</p><h3>Here the storage part finishes, hope they helped you so far. The last section would be how mining blocks work.</h3></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/tech-diarios">tech diarios</a></li><li><a href="/tags/filecoin">filecoin</a></li><li><a href="/tags/paths">paths</a></li><li><a href="/tags/scheduling">scheduling</a></li><li><a href="/tags/store-sector">store sector</a></li><li><a href="/tags/resource-windows">resource windows</a></li></ul></article></div></body></html>